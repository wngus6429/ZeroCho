{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[15],{RNiq:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"__N_SSP\",(function(){return p}));var c=n(\"nKUr\"),i=n(\"q1tI\"),r=n(\"1zst\"),a=n(\"/MKj\"),o=n(\"kduo\"),l=n(\"ODXe\"),s=n(\"Vl3Y\"),u=n(\"5rEg\"),d=n(\"2/Rp\"),j=n(\"p+NB\"),f=n(\"HlrF\"),b=function(){var e=Object(a.b)(),t=Object(a.c)((function(e){return e.post})),n=t.imagePaths,r=(t.addPostLoading,t.addPostDone),o=Object(f.a)(\"\"),b=Object(l.a)(o,3),p=b[0],O=b[1],h=b[2];Object(i.useEffect)((function(){r&&h(\"\")}),[r]);var m=Object(i.useCallback)((function(){if(!p||!p.trim())return alert(\"\\u6295\\u7a3f\\u3092\\u4f5c\\u6210\\u3057\\u3066\\u304f\\u3060\\u3055\\u3044\\u3002\");var t=new FormData;return n.forEach((function(e){t.append(\"image\",e)})),t.append(\"content\",p),e({type:j.e,data:t})}),[p,n]),g=Object(i.useRef)(),v=Object(i.useCallback)((function(){g.current.click()}),[g.current]),w=Object(i.useCallback)((function(t){console.log(\"images\",t.target.files);var n=new FormData;[].forEach.call(t.target.files,(function(e){n.append(\"image\",e)})),e({type:j.G,data:n})}),[]),x=Object(i.useCallback)((function(t){return function(){e({type:j.v,data:t})}}));return Object(c.jsxs)(s.a,{style:{margin:\"10px 0 20px\"},encType:\"multipart/form-data\",onFinish:m,children:[Object(c.jsx)(u.a.TextArea,{value:p,onChange:O,maxLength:140,placeholder:\"\\u3069\\u3093\\u306a\\u4e8b\\u4ef6\\u304c\\u3042\\u308a\\u307e\\u3057\\u305f\\u304b\\u3002\"}),Object(c.jsxs)(\"div\",{children:[Object(c.jsx)(\"input\",{type:\"file\",name:\"image\",multiple:!0,hidden:!0,ref:g,onChange:w}),Object(c.jsx)(d.a,{onClick:v,children:\"\\u30a4\\u30e1\\u30fc\\u30b8\\u30a2\\u30c3\\u30d7\\u30ed\\u30fc\\u30c9\"}),Object(c.jsx)(d.a,{type:\"primary\",style:{float:\"right\"},htmlType:\"submit\",children:\"\\u6295\\u7a3f\"})]}),Object(c.jsx)(\"div\",{children:n.map((function(e,t){return Object(c.jsxs)(\"div\",{style:{display:\"inline-block\"},children:[Object(c.jsx)(\"img\",{src:\"http://localhost:3065/\".concat(e),style:{width:\"200px\"},alt:e}),Object(c.jsx)(\"div\",{children:Object(c.jsx)(d.a,{onClick:x(t),children:\"\\u524a\\u9664\"})})]},e)}))})]})},p=!0;t.default=function(){var e=Object(a.b)(),t=Object(a.c)((function(e){return e.user})).me,n=Object(a.c)((function(e){return e.post})),l=n.mainPosts,s=n.hasMorePosts,u=n.loadPostsLoading,d=n.retweetError;return Object(i.useEffect)((function(){d&&alert(d)}),[d]),Object(i.useEffect)((function(){function t(){if(window.scrollY+document.documentElement.clientHeight>document.documentElement.scrollHeight-300&&s&&!u){var t,n=null===(t=l[l.length-1])||void 0===t?void 0:t.id;e({type:j.n,lastId:n})}}return window.addEventListener(\"scroll\",t),function(){window.removeEventListener(\"scroll\",t)}}),[s,u]),Object(c.jsxs)(r.a,{children:[t&&Object(c.jsx)(b,{}),l.map((function(e){return Object(c.jsx)(o.a,{post:e},e.id)}))]})}},vlRD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/\",function(){return n(\"RNiq\")}])}},[[\"vlRD\",1,2,4,7,0,3,5,6,8]]]);","extractedComments":[]}